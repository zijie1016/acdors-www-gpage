<!DOCTYPE html>
<html lang="zh">
<head>
  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge,chrome=1"/>
  <meta name="renderer" content="webkit"/>
  <meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1">
  <link rel="stylesheet" href="../css/acdors.css">
  <link rel="icon" href="/favicon.ico">
  <link href="../plugin/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" href="../plugin/swiper.js/2.7.6/css/idangerous.swiper.css">
  <link rel="stylesheet" href="../css/acdors.css">
  <!--[if lt IE 9]>
  <script src="../plugin/html5shiv/3.7.3/html5shiv.min.js"></script>
  <script src="../plugin/respond/1.4.2/respond.min.js"></script>
  <![endif]-->
  <title>星榜戏逗 - 剧组招募</title>
</head>
<body>

  <script src="../plugin/jquery/1.12.4/jquery.min.js"></script>
  <script src="../plugin/swiper.js/2.7.6/js/idangerous.swiper.min.js"></script>
  <script src="../plugin/bootstrap/3.3.7/js/bootstrap.min.js"></script>
  <script src="../js/acdors.js"></script>
  <script>
    $(function () {
      //创建页面公共组件
      createCommonComponents(2);

      //创建活动轮播框架
      $('body .navbar').after(buildSlideContainer({
        id: 'event-slides',
        class: 'main-carousel',
        pagiClass: 'pagination'
      }));
      // 请求活动轮播图数据
      ajaxGet({
        url: domainUrl + 'web/banner',
        data: {banner_area: 3},
        success: function(data){
          getBannerSlides(data, '#event-slides');
        } // success
      }); // ajaxGet()

      //创建热剧推荐结构
      $('#event-slides').after(buildCrewInfo('hot-recommend', '热剧推荐'));
      //请求热剧推荐数据
      ajaxGet({
        url: domainUrl + 'web/dramas',
        success: function (data) {
          // 请求推荐剧组数据
          if(data.isnull) { //后台没有上传剧组数据，展示"敬请期待"图片
            $('#hot-recommend').append(buildTBA('/img/tba.png'));
          }
          else { //请求到了剧组数据
            crews = data.data;
            for(var i=0, len=crews.length; i<len; ++i){
              getCrew(crews[i]);
            }
          } // else 请求到了剧组数据
        } // success
      }); //$.ajax 请求剧组信息
    }); // $(function(){})

    function getCrew(crew){
      // 剧组简单信息 
      $('#hot-recommend').append(buildIntroBlk(crew.crewinfo, true));
      $('#hot-recommend').append(buildSimpleText(crew.crewinfo.introduction));

      // 剧组明星介绍轮播图
      if(crew.actor.length != 0) { //如果没有返回演员的数据，就完全不展示轮播图
        var actors = crew.actor;
        // 创建明星轮播框架
        $('#hot-recommend').append(buildActorSlides());
        
        // 获取轮播数据
        for(var i=0,length=actors.length; i<length; ++i ) {
          $('#recommend-slides .swiper-wrapper').append(getImgSlide(ossUrl + actors[i].avatar, '明星轮播图')); // 图片
          $('#actor-info-slides .swiper-wrapper').append(getTextSlide(actors[i])); //介绍文本
        }
        // 明星轮播图片和文本关联 swiperjs 配置
        setBoundSlides({
          imgSlidesSelector: '#recommend-slides',
          textSlidesSelector: '#actor-info-slides',
          prevClass: 'arrow-left',
          nextClass: 'arrow-right',
          frequency: 6000,
          speed: 800
        }); // setBoundSlides
      } // if(actors[0].information != "")
    } // getCrew()

    function buildActorSlides(){
      var $actorSlides = buildSlideContainer({ // 明星图片
                id: 'recommend-slides',
                class: 'intro-carousel',
                prevClass: 'arrow-left',
                nextClass: 'arrow-right'
              });
      $actorSlides += buildSlideContainer({ // 明星介绍文本
                id: 'actor-info-slides',
                class: 'intro-text-carousel',
              });
      return $actorSlides;
    }
  </script>
</body>
</html>