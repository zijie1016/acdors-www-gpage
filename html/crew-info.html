<!DOCTYPE html>
<html lang="zh">
<head>
  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge,chrome=1"/>
  <meta name="renderer" content="webkit"/>
  <meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1">
  <link rel="icon" href="/favicon.ico">
  <link href="../plugin/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" href="../plugin/swiper.js/2.7.6/css/idangerous.swiper.css">
  <link rel="stylesheet" href="../css/acdors.css">
  <title>星榜戏逗 - 剧组详情</title>
</head>
<body>
  <script src="../plugin/jquery/1.12.4/jquery.min.js"></script>
  <script src="../plugin/swiper.js/2.7.6/js/idangerous.swiper.min.js"></script>
  <script src="../plugin/bootstrap/3.3.7/js/bootstrap.min.js"></script>
  <script src="../js/acdors.js"></script>
  <script src="../js/global.js"></script>
  <script>
    $(function () {
      //创建页面公共组件
      createCommonComponents(2);

      var index = GetQueryString('index');

      $.ajax({
        type: "get",
        url: domainUrl + 'web/dramas',
        async: true,
        dataType: "json",
        success: function (data) {
          var crew = data.data[index];
          var crewinfo = crew.crewinfo;
          
          $('.navbar').after('<div id="crew-info" class="container"></div>');
          $('#crew-info').append(buildIntroBlk({crewinfo: crewinfo, seeMore: false})); // 剧组简单图文信息
          $('#crew-info').append(buildSimpleText(crewinfo.introduction)); // 剧故事梗概

          // 剧组详情标签页 - 主创、人物小传、相册
          $('#crew-info').append(buildCrewTabs()); // 导航标签
          $('#creators').append(buildCreatorList(crew.creatorlist)); // 主创团队列表
          $('#biographies').append(buildBiographyList(crew.castlist)); // 人物小传列表
          $('#crew-album .row').append(buildAlbum(crew.crew_album)); // 剧组相册
        } // success
      }); // $.ajax
    }); // $(function)
    function buildCrewTabs(){
      return '<div class="crew-info-tabs">' +
            '<ul class="nav nav-tabs row">' +
              '<li class="active col-xs-4">' +
                '<a href="#creators" data-toggle="tab">主创团队</a>' +
              '</li>' +
              '<li class="col-xs-4">' +
                '<a href="#biographies" data-toggle="tab">人物小传</a>' +
              '</li>' +
              '<li class="col-xs-4">' +
                '<a href="#crew-album" data-toggle="tab">剧组相册</a>' +
              '</li>' +
            '</ul>' +
            '<div class="tab-content">' +
              '<div class="tab-pane active" id="creators"></div> ' +
              '<div class="tab-pane" id="biographies"></div>' +
              '<div class="tab-pane" id="crew-album"><div class="row"></div></div>' +
            '</div>' +
          '</div>';
    }
    function buildCreatorList(creatorList){
      var $creatorList = '';
      for(var i=0,len=creatorList.length; i<len; ++i) {
        $creatorList += buildCreatorItem(creatorList[i]);
      }
      return $creatorList;
    }
    function buildCreatorItem(creator){
      return '<div class="media">' +
            '<div class="media-left">' +
              '<img class="media-object img-circle" src="'+ ossUrl + creator.avatar +'" alt="主创照片">' +
            '</div>' +
            '<div class="media-body">' +
              '<table class="profile-info">' +
                '<thead>' +
                  '<tr><th colspan="2"><h3>'+ creator.name +'</h3></th></tr>' +
                '</thead>' +
                '<tbody>' +
                  '<tr>' +
                    '<th>职业：</th>' +
                    '<td>'+ creator.title +'</td>' +
                  '</tr>' +
                  '<tr>' +
                    '<th>作品：</th>' +
                    '<td>'+ creator.experiment +'</td>' +
                  '</tr>' +
                  '<tr>' +
                    '<th>简介：</th>' +
                    '<td>'+ creator.information +'</td>' +
                  '</tr>' +
                '</tbody>' +
              '</table>' +
            '</div>' +
          '</div>';
    }
    function buildBiographyList(biographyList){
      var $biographies = '';
      for(var i=0,len=biographyList.length; i<len; ++i) {
        $biographies += buildBiographyItem(biographyList[i]);
      }
      return $biographies;
    }
    function buildBiographyItem(biography){
      return '<div class="profile-free row">' +
            '<div class="profile-img col-xs-4 col-sm-3">' +
              '<img class="img-responsive img-circle" src="'+ ossUrl + biography.avatar +'" alt="人物图片">' +
            '</div>' +
            '<div class="profile-text-head col-xs-8 col-sm-9">' +
              '<h4>'+ biography.name +'</h4>' +
              '<p>' +
                '性别：' + ((biography.gender == "1") ? '男' : '女') + '<br>' +
                '角色：' + biography.position + '<br>' +
                '性格：' + biography.character +
              '</p>' +
            '</div>' +
            '<div class="profile-text-main col-xs-12 col-sm-9">' +
              '<table><tr>' +
                '<th>简介：</th>' +
                '<td>'+ biography.information +'</td>' +
              '</table></tr>' +
            '</div>' +
          '</div>';
    }
    function buildAlbum(album){
      var $album = '';
      for(var i=0,len=album.length; i<len; ++i) {
        $album += buildAlbumItem(album[i].photo);
      }
      return $album;
    }
    function buildAlbumItem(photo) {
      return '<img class="img-responsive col-xs-4 col-sm-4 col-md-3" src="'+ ossUrl + photo +'" alt="剧组相册">';
    }
  </script>
</body>
</html>

